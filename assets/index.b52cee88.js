import{g as c,a as d}from"./server.6774acdc.js";import{n as u}from"./index.298b6d96.js";const y={name:"MyPlay",data(){return{playState:!1,id:this.$route.query.id,songInfo:"",lyric:{},curLyric:"",lastLy:""}},computed:{needleDeg(){return this.playState?"-7deg":"-38deg"},picUrl(){return this.songInfo&&this.songInfo.al&&this.songInfo.al.picUrl}},methods:{async getSong(){const i=await c(this.id);console.log(i+"123"),this.songInfo=i.songs[0];const s=(await d(this.id)).lrc.lyric;this.lyric=this._formatLyr(s),this.curLyric=this.lyric[0]},_formatLyr(i){let t=/\[.+?\]/g,s=i.match(t),e=i.split(/\[.+?\]/).slice(1),r={};return s.forEach((a,n)=>{let l=a.split(":")[0].split("")[2]*60,o=a.split(":")[1].split(".")[0].split("")[0]==="0"?a.split(":")[1].split(".")[0].split("")[1]:a.split(":")[1].split(".")[0];r[l+Number(o)]=e[n]}),r},audioStart(){this.playState?this.$refs.audio.pause():this.$refs.audio.play(),this.playState=!this.playState},showLyric(){this.$refs.audio.ontimeupdate=()=>{let i=Math.floor(this.$refs.audio.currentTime);this.lyric[i]?(this.curLyric=this.lyric[i],this.lastLy=this.curLyric):this.curLyric=this.lastLy}}},mounted(){this.getSong(),this.showLyric()},beforeDestroy(){this.$refs.audio.ontimeupdate=null}};var p=function(){var t=this,s=t._self._c;return s("div",{staticClass:"play"},[s("div",{staticClass:"song-bg",style:`background-image: url(${t.picUrl}?imageView&thumbnail=360y360&quality=75&tostatic=0);`}),s("div",{staticClass:"header"},[s("van-icon",{staticClass:"left-incon",attrs:{name:"arrow-left",size:"20"},on:{click:function(e){return t.$router.back()}}})],1),s("div",{staticClass:"song-wrapper"},[s("div",{staticClass:"song-turn ani",style:`animation-play-state:${t.playState?"running":"paused"}`},[s("div",{staticClass:"song-img"},[s("img",{staticStyle:{width:"100%"},attrs:{src:`${t.picUrl}?imageView&thumbnail=360y360&quality=75&tostatic=0`,alt:""}})])]),s("div",{staticClass:"start-box",on:{click:t.audioStart}},[s("span",{directives:[{name:"show",rawName:"v-show",value:!t.playState,expression:"!playState"}],staticClass:"song-start"})]),s("div",{staticClass:"song-msg"},[s("h2",{staticClass:"m-song-h2"},[s("span",{staticClass:"m-song-sname"},[t._v(t._s(t.songInfo.name)+"-"+t._s(t.songInfo&&t.songInfo.ar&&t.songInfo.ar[0].name))])]),s("div",{staticClass:"lrcContent"},[s("p",{staticClass:"lrc"},[t._v(t._s(t.curLyric))])])]),s("div",{staticClass:"needle",style:`transform: rotate(${t.needleDeg});`})]),s("audio",{ref:"audio",attrs:{preload:"true",src:`https://music.163.com/song/media/outer/url?id=${t.id}.mp3`}})])},h=[],g=u(y,p,h,!1,null,"08d14c1b",null,null);const _=g.exports;export{_ as default};
